<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√úberraschung!</title>
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta name="theme-color" content="#2a3b4c">
    <style>
        /* Weihnachtliche Animationen mit Lametta, Sternen und Schneeflocken */
        @keyframes confetti-fall { 0% { transform: translateY(-100%) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
        @keyframes snow-fall { 0% { transform: translateY(-100%) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; } }
        @keyframes star-twinkle { 0%, 100% { transform: translateY(-100%) rotate(0deg) scale(1); opacity: 1; } 50% { transform: translateY(50vh) rotate(180deg) scale(1.5); opacity: 0.8; } 100% { transform: translateY(100vh) rotate(360deg) scale(1); opacity: 0; } }
        @keyframes icon-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #2a3b4c; color: #ffffff; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; text-align: center; }
        .container { animation: icon-bounce 2s infinite ease-in-out; }
        h1 { font-size: 2.5rem; color: #f0c04a; text-shadow: 0 0 10px #f0c04a; }
        p { font-size: 1.5rem; }
        .icon { font-size: 5rem; display: block; margin-bottom: 1rem; }
        .confetti { position: fixed; top: 0; left: 0; width: 10px; height: 20px; opacity: 0; animation: confetti-fall 8s linear infinite; }
        .star { position: fixed; top: 0; left: 0; font-size: 1.5rem; opacity: 0; animation: star-twinkle 10s ease-in-out infinite; }
        .snowflake { position: fixed; top: 0; left: 0; font-size: 1.2rem; opacity: 0; animation: snow-fall 12s linear infinite; color: #ffffff; }
        .tinsel { position: fixed; top: 0; left: 0; width: 3px; height: 40px; opacity: 0; animation: confetti-fall 10s linear infinite; background: linear-gradient(180deg, #FFD700, #FFA500, #FFD700); box-shadow: 0 0 5px #FFD700; }
    </style>
</head>
<body>
    <div class="container">
        <span class="icon" id="b-icon">üéÅ</span>
        <h1 id="b-title">...</h1>
        <p id="b-message">...</p>
    </div>

    <script>
        // --- NEUE TENANT-LOGIK ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Tenant aus URL lesen (genau wie bei Ihrer PWA)
            const params = new URLSearchParams(window.location.search);
            const tenantId = params.get('tenant') || 'default';

            // 2. Passende Konfiguration laden
            fetch(`branding/${tenantId}/config.json`)
                .then(response => {
                    if (!response.ok) {
                        // Fallback, wenn Tenant nicht existiert
                        return fetch('branding/default/config.json');
                    }
                    return response.json();
                })
                //.then(response => response.json())
                .then(config => {
                    // 3. Seite mit Tenant-Daten f√ºllen
                    document.getElementById('b-icon').textContent = config.icon;
                    document.getElementById('b-title').textContent = config.title;
                    document.getElementById('b-message').innerHTML = config.message;
                    document.title = config.name; // Browser-Tab-Titel
                })
                .catch(err => {
                    console.error('Konnte Konfiguration nicht laden:', err);
                    document.getElementById('b-title').textContent = "Hoppla!";
                    document.getElementById('b-message').textContent = "Hier ist was schiefgelaufen.";
                });
            
            // 4. Konfetti (unver√§ndert)
            startConfetti();
        });

        function startConfetti() {
            function createParticle() {
                const types = [
                    { class: 'confetti', duration: 8000, colors: ['#D40000', '#FFD700', '#FFFFFF', '#8B0000', '#00FF00'] },
                    { class: 'star', duration: 10000, content: '‚≠ê' },
                    { class: 'star', duration: 10000, content: '‚ú®' },
                    { class: 'snowflake', duration: 12000, content: '‚ùÑÔ∏è' },
                    { class: 'snowflake', duration: 12000, content: '‚ùÖ' },
                    { class: 'tinsel', duration: 10000 }
                ];

                const type = types[Math.floor(Math.random() * types.length)];
                const particle = document.createElement('div');
                particle.className = type.class;
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 2 + 's';

                if (type.colors) {
                    // F√ºr Konfetti: zuf√§llige Farbe
                    particle.style.backgroundColor = type.colors[Math.floor(Math.random() * type.colors.length)];
                } else if (type.content) {
                    // F√ºr Sterne und Schneeflocken: Emoji/Unicode-Zeichen
                    particle.textContent = type.content;
                }

                document.body.appendChild(particle);
                setTimeout(() => { particle.remove(); }, type.duration);
            }

            // Initiale Partikel
            for (let i = 0; i < 150; i++) {
                setTimeout(createParticle, i * 30);
            }

            // Kontinuierlich neue Partikel erstellen (Weihnachtszauber h√∂rt nie auf!)
            setInterval(() => {
                for (let i = 0; i < 3; i++) {
                    setTimeout(createParticle, i * 100);
                }
            }, 1000);
        }
    </script>
</body>

</html>
